# -*- coding: utf-8 -*-
"""app.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1zlAywC9VtSylfHCaBGp6EPT3Gi1NXsGV
"""

pip install streamlit seaborn matplotlib pandas

import streamlit as st
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.metrics import confusion_matrix

# Data prediksi
predictions_data = pd.read_csv('student_dropout_predictions.csv')

# Membuat DataFrame
predictions_df = pd.DataFrame(predictions_data)

# Streamlit Title
st.title('Monitoring Risiko Dropout Siswa')

# Menampilkan DataFrame
st.subheader('Data Prediksi Status Siswa')
st.write(predictions_df)

# Distribusi Probabilitas Dropout
st.subheader('Distribusi Probabilitas Dropout Siswa')
fig, ax = plt.subplots(figsize=(10, 6))
sns.histplot(predictions_df['Probability_of_Dropout'], kde=True, color='red', ax=ax)
ax.set_title('Distribusi Probabilitas Dropout Siswa')
ax.set_xlabel('Probability of Dropout')
ax.set_ylabel('Frequency')
st.pyplot(fig)

# Probabilitas Dropout vs Prediksi Status
st.subheader('Probabilitas Dropout Berdasarkan Prediksi Status')
fig, ax = plt.subplots(figsize=(10, 6))
sns.boxplot(x='Predicted_Status', y='Probability_of_Dropout', data=predictions_df, ax=ax)
ax.set_title('Probabilitas Dropout Berdasarkan Prediksi Status')
ax.set_xlabel('Predicted Status (0: Dropout, 2: Graduate, 1: Enrolled)')
ax.set_ylabel('Probability of Dropout')
st.pyplot(fig)

# Confusion Matrix
st.subheader('Matriks Kebingungan (Confusion Matrix)')
cm = confusion_matrix(predictions_df['Actual_Status'].map({'Graduate': 2, 'Enrolled': 1, 'Dropout': 0}),
                      predictions_df['Predicted_Status'])
fig, ax = plt.subplots(figsize=(8, 6))
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues', xticklabels=['Dropout', 'Enrolled', 'Graduate'], yticklabels=['Dropout', 'Enrolled', 'Graduate'], ax=ax)
ax.set_title('Confusion Matrix')
ax.set_xlabel('Predicted Status')
ax.set_ylabel('Actual Status')
st.pyplot(fig)

# Siswa berisiko dropout
st.subheader('Siswa Berisiko Dropout')
high_risk_students = predictions_df[predictions_df['Probability_of_Dropout'] > 0.5]
st.write(high_risk_students[['Marital_status', 'Course', 'Predicted_Status', 'Probability_of_Dropout']])